// Configurações iniciais do Express e SQLite...

// Rotas para Movimento
app.get("/movimento/completo", (req, res) => {
    const search = req.query.search || "";

    if (!search) {
        return res.status(400).json({ message: "Termo de pesquisa é obrigatório." });
    }

    const query = `
        SELECT 
            c.codigo, 
            c.nome, 
            c.idade, 
            c.telefone, 
            c.email,
            c.cpf,
            c.endereco,
            c.emergencia,
            m.mes,
            m.treinos,
            m.faltas,
            m.valor,
            m.pago
        FROM clientes c
        LEFT JOIN movimento m ON c.codigo = m.codigo
        WHERE c.codigo LIKE ? OR c.nome LIKE ? OR c.cpf LIKE ?
        ORDER BY c.nome, m.mes DESC
    `;

    const searchParam = `%${search}%`;
    db.all(query, [searchParam, searchParam, searchParam], (err, rows) => {
        if (err) {
            console.error(err);
            return res.status(500).json({ message: "Erro ao buscar movimento." });
        }
        res.json(rows);
    });
});

// Suas outras rotas para movimento...
app.post("/movimento", (req, res) => {
    // Sua implementação existente
});

app.get("/movimento", (req, res) => {
    // Sua implementação existente
});

app.put("/movimento/codigo/:codigo/mes/:mes", (req, res) => {
    // Sua implementação existente
});
